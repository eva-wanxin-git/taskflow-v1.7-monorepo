# 👥 AI团队协作指南

**版本**: v1.0  
**更新时间**: 2025-11-18  
**项目**: 任务所·Flow及接入项目

---

## 🎯 概述

任务所·Flow提供了**4个AI角色**，形成完整的开发团队：

| 角色 | 职责 | 经验等级 | Prompt文件 |
|------|------|---------|-----------|
| 🏛️ 架构师 | 分析、规划、拆解、审查 | Staff Engineer | architect-system-prompt-expert.md |
| 👨‍💻 全栈工程师 | 实现、测试、文档 | 10年经验 | fullstack-engineer-system-prompt.md |
| 🧰 代码管家 | 稳定实现、质量保证 | 8年经验 | code-steward-system-prompt.md |
| 🛡️ SRE工程师 | 部署、监控、运维 | SRE专家 | sre-system-prompt.md |

---

## 🚀 快速开始

### 场景1：新项目快速接入

#### Step 1：启动架构师
```
@taskflow-v1.7-monorepo/docs/ai/architect-system-prompt-expert.md

认命你为这个项目的架构师
```

**架构师会**（10-15分钟）：
- 扫描项目结构
- 生成4份文档
- 拆解任务列表

#### Step 2：派任务给全栈工程师
```
@taskflow-v1.7-monorepo/docs/ai/fullstack-engineer-system-prompt.md
@docs/tasks/task-board.md

李明，请实现任务ARCH-001
```

**全栈工程师会**：
- 确认任务理解
- 实现代码+测试
- 提交完成报告

#### Step 3：配置运维
```
@taskflow-v1.7-monorepo/docs/ai/sre-system-prompt.md

作为SRE，请为这个项目设计部署和监控方案
```

**SRE会**：
- 设计部署流程
- 配置监控告警
- 编写运维手册

---

## 📋 详细使用流程

### 阶段1：项目启动（由架构师主导）

#### 1.1 架构师接管项目
```markdown
@docs/ai/architect-system-prompt-expert.md

认命你为【项目名称】的架构师。

这是一个【简单描述项目】的项目。
当前痛点：【列出1-3个主要问题】

请分析并制定重构计划。
```

#### 1.2 架构师产出
**10-15分钟后获得**：
- `docs/arch/architecture-inventory.md` - 项目概览
- `docs/arch/architecture-review.md` - 审查报告（✅已实现 🟡部分实现 🔴问题）
- `docs/arch/refactor-plan.md` - 重构计划（分阶段）
- `docs/tasks/task-board.md` - 任务列表（24个任务）

#### 1.3 同步到任务所（可选）
```python
# 架构师会自动调用
POST /api/architect/analysis
{
  "project_code": "MY_PROJECT",
  "completed_features": [...],
  "problems": [...],
  "suggested_tasks": [...]
}
```

---

### 阶段2：任务执行（由全栈工程师主导）

#### 2.1 派发任务
```markdown
@docs/ai/fullstack-engineer-system-prompt.md
@docs/tasks/task-board.md

李明（全栈工程师），

请实现任务ARCH-001：【任务标题】

任务详情见task-board.md，补充说明：
- 【补充1】
- 【补充2】

优先关注：【代码质量/性能/快速上线】
```

#### 2.2 全栈工程师工作流

**第一步：确认理解**（5分钟）
```
全栈工程师回复：
✅ 已收到任务ARCH-001
📋 任务理解：[复述需求]
🎯 预期输出：[列出文件]
⚠️ 需确认：[如有疑问]
```

**第二步：自动自查**（10分钟）
```
已查阅：
- 代码：apps/api/src/...
- 文档：docs/arch/...
- 任务板：docs/tasks/...

已了解：
- [相关模块]
- [技术栈]

开始实现...
```

**第三步：实现代码**（30-90分钟）
- 编写代码
- 编写测试
- 自我QA

**第四步：提交报告**（10分钟）
```
🎉 任务完成总结报告

1. 任务概述：[...]
2. 实现内容：[...]
3. 涉及文件：[...]
4. 测试验证：[...]
5. 风险注意：[...]
6. 后续建议：[...]

已生成并呈送给【总架构师】，请查收。
```

---

### 阶段3：代码审查（由架构师主导）

#### 3.1 架构师审查
```markdown
@docs/ai/architect-system-prompt-expert.md

李明（全栈工程师）已完成任务ARCH-001，
请审查代码质量，判断是否符合验收标准。
```

#### 3.2 架构师审查清单
- [ ] 功能是否完整？
- [ ] 代码质量是否达标？
- [ ] 测试是否充分？
- [ ] 文档是否更新？
- [ ] 有无引入技术债？

#### 3.3 审查结果
**通过**：
```markdown
✅ 审查通过

ARCH-001任务验收合格：
- 功能完整，符合需求
- 代码质量良好
- 测试覆盖充分

任务状态：已完成 → 已验收
```

**需修改**：
```markdown
⚠️ 审查发现问题

ARCH-001需要修改：
1. [具体问题1]
2. [具体问题2]

请李明修复后重新提交。
```

---

### 阶段4：部署运维（由SRE主导）

#### 4.1 配置部署
```markdown
@docs/ai/sre-system-prompt.md

新功能【依赖图可视化】已开发完成，
请配置部署和监控。
```

#### 4.2 SRE产出
- 部署脚本
- 监控告警规则
- 运维手册
- 回滚方案

---

## 🎭 AI角色详解

### 🏛️ 架构师AI（Staff Engineer）

**何时使用**：
- ✅ 项目初次接入（需要分析和规划）
- ✅ 重大架构决策（技术选型、重构方向）
- ✅ 代码审查（质量把关）
- ✅ 定期Review（每2周）

**不适合用于**：
- ❌ 写具体业务代码
- ❌ 修复简单Bug
- ❌ 写测试代码

**启动方式**：
```
@docs/ai/architect-system-prompt-expert.md
认命你为架构师
```

**产出**：
- 4份文档（inventory/review/refactor-plan/task-board）
- 任务列表（拆解好的、可执行的任务）
- 技术决策（ADR）

---

### 👨‍💻 全栈工程师AI（李明）

**何时使用**：
- ✅ 实现具体功能（前端+后端）
- ✅ Bug修复
- ✅ 重构代码
- ✅ 写测试

**不适合用于**：
- ❌ 架构设计（让架构师做）
- ❌ 运维部署（让SRE做）

**启动方式**：
```
@docs/ai/fullstack-engineer-system-prompt.md

李明，请实现任务ARCH-001

（或使用task-prompt-template.md填写详细任务）
```

**产出**：
- 代码（前端+后端）
- 测试（单元+集成）
- 文档（API文档、注释）
- 完成总结报告

---

### 🧰 代码管家AI

**何时使用**：
- ✅ 如果不需要前端，只做后端
- ✅ 专注代码质量
- ✅ 与全栈工程师角色类似，但更专注后端

**启动方式**：
```
@docs/ai/code-steward-system-prompt.md
请实现任务ARCH-001
```

---

### 🛡️ SRE AI

**何时使用**：
- ✅ 配置部署
- ✅ 设计监控
- ✅ 编写运维手册
- ✅ 事故处理

**不适合用于**：
- ❌ 写业务代码

**启动方式**：
```
@docs/ai/sre-system-prompt.md
作为SRE，请配置部署和监控
```

---

## 🔄 完整工作流示例

### 示例：开发一个新功能"审计日志"

#### Day 1 上午：架构师规划
```
@architect-system-prompt-expert.md

认命你为架构师，深入分析审计日志需求
```

**产出**：
- 审计日志的技术方案（3个选项对比）
- 拆解的任务列表（后端、前端、运维）
- 写入task-board.md

#### Day 1 下午：全栈工程师实现后端
```
@fullstack-engineer-system-prompt.md

李明，请实现ARCH-010：审计日志后端API

详情：
- 数据库Schema已有（audit_log表）
- 需要实现POST /api/audit/log和GET /api/audit/logs
- 支持筛选（user_id, action, date_range）
```

**产出**：
- API代码
- 单元测试
- 完成报告

#### Day 2 上午：架构师审查后端
```
@architect-system-prompt-expert.md

审查李明提交的ARCH-010后端代码
```

**产出**：
- 审查意见（通过/修改）

#### Day 2 下午：全栈工程师实现前端
```
@fullstack-engineer-system-prompt.md

李明，后端API已验收，请实现ARCH-011：审计日志前端页面
```

**产出**：
- 前端页面
- 集成测试
- 完成报告

#### Day 3：SRE配置运维
```
@sre-system-prompt.md

审计日志功能已完成，请配置：
1. 日志存储策略（保留30天）
2. 监控告警（异常操作告警）
3. 备份方案
```

**产出**：
- 部署脚本
- 监控配置
- 运维手册

---

## 💡 最佳实践

### 1. 明确的职责边界

```
问：这个功能需要优化性能
谁负责？

回答：
- 架构师：分析性能瓶颈，设计优化方案
- 全栈工程师：实现优化代码
- SRE：配置性能监控
```

### 2. 使用任务板协调

```
所有任务都记录在task-board.md中：
- 架构师：创建和更新任务
- 全栈工程师：领取和完成任务
- SRE：配置相关的运维任务

避免口头派活，一切以任务板为准。
```

### 3. 完整的闭环

```
架构师 → 拆解任务 → task-board.md
    ↓
全栈工程师 ← 领取任务 ← task-board.md
    ↓
全栈工程师 → 提交报告 → 架构师
    ↓
架构师 → 审查验收 → 更新task-board
    ↓
SRE ← 部署上线 ← 已验收功能
```

### 4. 知识沉淀

```
每个任务完成后：
- 问题记录到issues表
- 解决方案记录到solutions表
- 技术决策记录到decisions表/ADR
- 形成可检索的知识库
```

---

## 📊 AI团队配置建议

### 小型项目（1-5人团队）
**推荐配置**：
- 架构师AI（定期使用，每周1次）
- 全栈工程师AI（主力，每天使用）

**原因**：
- 小团队需要多面手
- 全栈工程师覆盖前后端
- 架构师把控方向

### 中型项目（5-20人团队）
**推荐配置**：
- 架构师AI（常驻，每天使用）
- 全栈工程师AI（多个，按模块分配）
- SRE AI（专职，运维相关任务）

**原因**：
- 需要专人专职
- 架构师协调全局
- SRE保障稳定

### 大型项目（20+人团队）
**推荐配置**：
- 架构师AI（多个，按领域分）
- 专项AI（后端AI、前端AI、测试AI）
- SRE AI（多个，按环境分）

**原因**：
- 复杂度需要专业分工
- 每个AI负责特定领域

---

## 🎯 任务派发模板

### 给全栈工程师的标准模板

**使用**：`docs/ai/task-prompt-template.md`

**填写要点**：
```markdown
# 【任务所·Flow】全栈开发任务说明

## 任务ID
ARCH-XXX

## 任务目标
[1-2句话说清楚要做什么]

## 背景信息
[提供必要上下文]

## 期望产出
- 后端：[...]
- 前端：[...]
- 测试：[...]
- 文档：[...]

## 设计约束
[如果有特殊要求]

李明，交给你了！
```

---

## 🔧 高级技巧

### 技巧1：角色切换

**在同一个对话中切换角色**：
```
# 当前是架构师模式
[分析完成]

现在切换到全栈工程师模式：
@fullstack-engineer-system-prompt.md

李明，实现刚才架构师规划的任务
```

### 技巧2：角色协作

**让两个AI协作**：
```
# 架构师拆解任务
@architect-system-prompt-expert.md
拆解「审计日志」功能为可执行任务

# 获得任务列表后
@fullstack-engineer-system-prompt.md
李明，实现第一个任务

# 完成后
@architect-system-prompt-expert.md
审查李明的代码
```

### 技巧3：并行工作

**多个工程师并行**：
```
# 对话1：后端工程师
@fullstack-engineer-system-prompt.md
李明，实现后端API（ARCH-010）

# 对话2：前端工程师
@fullstack-engineer-system-prompt.md
李明，实现前端页面（ARCH-011）

# 对话3：SRE工程师
@sre-system-prompt.md
配置部署脚本（ARCH-012）
```

---

## 📚 完整案例

### 案例：从零到上线

#### Week 1：架构和核心功能
```
Day 1: 架构师分析项目 → 生成任务板
Day 2-3: 全栈工程师实现核心功能（ARCH-001~005）
Day 4: 架构师审查代码
Day 5: SRE配置部署
```

#### Week 2：补充功能和优化
```
Day 1: 架构师更新分析（基于Week 1变更）
Day 2-4: 全栈工程师实现补充功能
Day 5: 集成测试和bug修复
```

#### Week 3：上线准备
```
Day 1-2: SRE配置生产环境
Day 3: 全栈工程师修复staging发现的问题
Day 4: 压力测试和性能优化
Day 5: 生产部署
```

---

## ⚠️ 注意事项

### 1. 不要混淆角色

**错误示例**：
```
❌ 让架构师写具体代码
❌ 让全栈工程师做架构设计
❌ 让SRE写业务逻辑
```

**正确示例**：
```
✅ 架构师：分析和规划
✅ 全栈工程师：实现和测试
✅ SRE：部署和监控
```

### 2. 保持沟通

**架构师和工程师要对齐**：
- 全栈工程师发现设计问题→告诉架构师
- 架构师调整计划→通知全栈工程师

### 3. 文档驱动

**所有工作基于文档**：
- 架构师写文档（inventory/review/refactor-plan）
- 全栈工程师读文档（理解上下文）
- SRE读文档（了解系统）
- 文档是团队沟通的基础

---

## 📊 效率对比

### 传统方式 vs AI团队

| 任务 | 传统方式 | AI团队 | 提效 |
|------|---------|--------|------|
| 项目分析 | 2-3天 | 10分钟 | 300倍 |
| 任务拆解 | 半天 | 5分钟 | 50倍 |
| 代码实现 | 2-3天 | 2-4小时 | 5倍 |
| 代码审查 | 半天 | 10分钟 | 30倍 |
| 文档编写 | 1天 | 自动生成 | 无限 |

**整体提效**: 约**10-20倍**

---

## 🎊 总结

### AI团队的核心优势

1. **专业分工**
   - 每个AI专注自己擅长的
   - 职责清晰，不越界

2. **高效协作**
   - 通过任务板和文档协调
   - 通过任务所·Flow API同步

3. **知识沉淀**
   - 每次工作都有文档
   - 问题和方案都入库
   - 可检索、可复用

4. **持续改进**
   - 架构师定期Review
   - 发现问题及时优化
   - 形成最佳实践

---

**文档版本**：v1.0  
**最后更新**：2025-11-18  
**状态**：✅ 完整可用

👥 **这是AI团队的完整协作指南 - 高效专业！**

