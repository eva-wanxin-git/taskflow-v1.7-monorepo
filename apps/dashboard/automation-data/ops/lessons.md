# 经验教训

## v1.7开发教训

### 1. Monorepo迁移要注意数据层兼容性
**教训**: 从v1.6复制Dashboard代码到v1.7时，忘记检查数据库Schema兼容性
**影响**: Dashboard无法启动，花费25分钟调试
**预防**: 
- 迁移前对比Schema差异
- 编写兼容性测试
- 提供自动修复脚本

### 2. API端点定义要避免重复
**教训**: 同一个路由在不同位置定义两次，后者覆盖前者
**影响**: 功能清单API不生效
**预防**:
- 搜索重复的@app.get装饰器
- 使用IDE查找引用
- 代码审查时检查

### 3. 数据格式要统一
**教训**: 状态值有的用大写(PENDING)，有的用小写(pending)
**影响**: Pydantic验证失败
**预防**:
- 定义枚举常量
- 使用Enum类型
- 数据库约束CHECK

## v1.6开发教训

### Tab切换失效
**教训**: Python f-string中包含JS模板字符串时，反引号未转义
**影响**: 整个script标签语法错误
**预防**:
- 使用node -c检查JS语法
- 将JS提取到独立文件
- 或使用前后端分离

### 端口冲突
**教训**: 多个项目使用固定端口导致冲突
**解决**: 开发PortManager自动分配端口
**成果**: v1.7使用8870-8899专用端口段
